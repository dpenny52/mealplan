---
phase: 01-foundation
plan: 02
type: execute
wave: 2
depends_on: ["01-01"]
files_modified:
  - src/app/_layout.tsx
  - src/app/(tabs)/_layout.tsx
  - src/app/(tabs)/planner.tsx
  - src/app/(tabs)/recipes.tsx
  - src/app/(tabs)/grocery.tsx
autonomous: true

must_haves:
  truths:
    - "App launches and displays bottom tab navigation"
    - "User can tap each tab and see corresponding screen"
    - "All screens display in dark mode (dark background, light text)"
    - "Planner tab is the default/home screen on app launch"
  artifacts:
    - path: "src/app/_layout.tsx"
      provides: "Root layout with ConvexProvider, SafeAreaProvider, theme"
      contains: "ConvexProvider"
    - path: "src/app/(tabs)/_layout.tsx"
      provides: "Tab bar configuration with 3 tabs"
      contains: "Tabs.Screen"
    - path: "src/app/(tabs)/planner.tsx"
      provides: "Planner placeholder screen"
      contains: "Meal Planner"
    - path: "src/app/(tabs)/recipes.tsx"
      provides: "Recipes placeholder screen"
      contains: "Recipes"
    - path: "src/app/(tabs)/grocery.tsx"
      provides: "Grocery placeholder screen"
      contains: "Grocery"
  key_links:
    - from: "src/app/_layout.tsx"
      to: "ConvexReactClient"
      via: "EXPO_PUBLIC_CONVEX_URL env var"
      pattern: "process\\.env\\.EXPO_PUBLIC_CONVEX_URL"
    - from: "src/app/(tabs)/_layout.tsx"
      to: "src/constants/theme.ts"
      via: "import Colors"
      pattern: "import.*Colors.*from"
    - from: "src/app/(tabs)/planner.tsx"
      to: "react-native-safe-area-context"
      via: "useSafeAreaInsets hook"
      pattern: "useSafeAreaInsets"
---

<objective>
Create the navigation structure with bottom tabs and dark mode theming across all screens.

Purpose: Deliver the core user-facing shell - the navigation that users will interact with throughout the app. This satisfies UI-01 (dark mode) and provides the structure for all future screens.

Output: Working app with 3 tabs (Recipes, Planner, Grocery), dark mode theme, friendly empty states.
</objective>

<context>
@.planning/PROJECT.md
@.planning/phases/01-foundation/01-RESEARCH.md
@.planning/phases/01-foundation/01-CONTEXT.md
@.planning/phases/01-foundation/01-01-SUMMARY.md
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create root layout with providers</name>
  <files>
    - src/app/_layout.tsx
  </files>
  <action>
Create src/app/_layout.tsx as the app entry point with all required providers:

1. Import from:
   - expo-router: Stack
   - expo-status-bar: StatusBar
   - convex/react: ConvexProvider, ConvexReactClient
   - @react-navigation/native: ThemeProvider
   - react-native-safe-area-context: SafeAreaProvider

2. Create ConvexReactClient at module level:
   ```typescript
   const convex = new ConvexReactClient(process.env.EXPO_PUBLIC_CONVEX_URL!, {
     unsavedChangesWarning: false,  // Required for React Native
   });
   ```

3. Define DarkTheme object with colors from theme.ts:
   ```typescript
   const DarkTheme = {
     dark: true,
     colors: {
       primary: Colors.primary,      // Orange accent
       background: Colors.background, // Dark gray
       card: Colors.surface,          // Surface color
       text: Colors.text,             // Off-white
       border: Colors.border,         // Subtle border
       notification: Colors.primary,  // Orange
     },
     fonts: {
       regular: { fontFamily: 'System', fontWeight: '400' },
       medium: { fontFamily: 'System', fontWeight: '500' },
       bold: { fontFamily: 'System', fontWeight: '700' },
       heavy: { fontFamily: 'System', fontWeight: '900' },
     },
   };
   ```

4. Export default RootLayout component that wraps:
   - ConvexProvider (outermost - provides Convex context)
   - SafeAreaProvider (handles device safe areas)
   - ThemeProvider with DarkTheme value
   - Stack with headerShown: false, containing (tabs) screen
   - StatusBar with style="light"
  </action>
  <verify>
    - File exists at src/app/_layout.tsx
    - Imports ConvexProvider from convex/react
    - Uses EXPO_PUBLIC_CONVEX_URL from env
    - StatusBar style is "light" (for dark mode)
  </verify>
  <done>Root layout wraps app in ConvexProvider, SafeAreaProvider, and ThemeProvider with dark theme</done>
</task>

<task type="auto">
  <name>Task 2: Create tab navigation layout</name>
  <files>
    - src/app/(tabs)/_layout.tsx
  </files>
  <action>
Create src/app/(tabs)/_layout.tsx with bottom tab configuration:

1. Import from:
   - expo-router: Tabs
   - @expo/vector-icons/Ionicons: Ionicons
   - src/constants/theme: Colors

2. Export default TabLayout component with Tabs configuration:
   ```typescript
   <Tabs
     initialRouteName="planner"  // Planner is default/home
     screenOptions={{
       headerShown: false,  // No header bars (per CONTEXT.md)
       tabBarActiveTintColor: Colors.primary,     // Orange
       tabBarInactiveTintColor: Colors.textSecondary, // Muted gray
       tabBarStyle: {
         backgroundColor: Colors.surface,
         borderTopColor: Colors.border,
         borderTopWidth: 1,
       },
       tabBarLabelStyle: {
         fontSize: 12,
         fontWeight: '500',
       },
     }}
   >
   ```

3. Define three Tabs.Screen components in visual order (left to right):
   - recipes: title "Recipes", icon "book-outline"
   - planner: title "Planner", icon "calendar-outline"
   - grocery: title "Grocery", icon "cart-outline"

4. Each screen uses tabBarIcon with Ionicons:
   ```typescript
   tabBarIcon: ({ color, size }) => (
     <Ionicons name="icon-name" size={size} color={color} />
   )
   ```
  </action>
  <verify>
    - File exists at src/app/(tabs)/_layout.tsx
    - Contains 3 Tabs.Screen definitions
    - initialRouteName is "planner"
    - Uses Colors from theme.ts for styling
  </verify>
  <done>Tab bar configured with 3 tabs, dark styling, Planner as default</done>
</task>

<task type="auto">
  <name>Task 3: Create placeholder screen components</name>
  <files>
    - src/app/(tabs)/planner.tsx
    - src/app/(tabs)/recipes.tsx
    - src/app/(tabs)/grocery.tsx
  </files>
  <action>
Create three screen files with placeholder content. Each screen follows the same pattern:

1. Import from:
   - react-native: View, Text, StyleSheet
   - react-native-safe-area-context: useSafeAreaInsets
   - src/constants/theme: Colors, Spacing

2. Create screen component with safe area handling:
   ```typescript
   export default function ScreenName() {
     const insets = useSafeAreaInsets();
     return (
       <View style={[styles.container, { paddingTop: insets.top }]}>
         <Text style={styles.title}>Screen Title</Text>
         <View style={styles.emptyState}>
           <Text style={styles.emptyText}>Empty state message</Text>
           <Text style={styles.emptySubtext}>Helpful hint</Text>
         </View>
       </View>
     );
   }
   ```

3. Create StyleSheet with dark mode colors:
   - container: flex 1, backgroundColor: Colors.background, padding: Spacing.md
   - title: fontSize 28, fontWeight bold, color: Colors.text, marginBottom: Spacing.lg
   - emptyState: flex 1, justifyContent center, alignItems center
   - emptyText: fontSize 18, color: Colors.textSecondary
   - emptySubtext: fontSize 14, color: Colors.textMuted, marginTop: Spacing.sm

**Planner screen (planner.tsx):**
- Title: "Meal Planner"
- Empty state: "No meals planned yet"
- Subtext: "Your weekly meal plan will appear here"

**Recipes screen (recipes.tsx):**
- Title: "Recipes"
- Empty state: "No recipes yet"
- Subtext: "Add your first recipe to get started"

**Grocery screen (grocery.tsx):**
- Title: "Grocery List"
- Empty state: "No items on your list"
- Subtext: "Generate a list from your meal plan"
  </action>
  <verify>
    - All 3 files exist in src/app/(tabs)/
    - Each uses useSafeAreaInsets for safe area handling
    - Each displays title and empty state message
    - Colors match dark mode theme (dark background, light text)
  </verify>
  <done>All 3 placeholder screens created with dark mode styling and friendly empty states</done>
</task>

</tasks>

<verification>
After all tasks complete:
1. `npx expo start` launches without errors
2. App shows tab bar at bottom with 3 tabs
3. Default screen is Planner (center tab)
4. Tapping each tab shows corresponding screen
5. All screens have dark background (#121212) and light text
6. Tab bar has dark surface color (#1E1E1E)
7. Active tab shows orange (#FF9800) tint
</verification>

<success_criteria>
- App launches and displays bottom tabs navigation
- Planner is the default/home screen
- All 3 screens accessible via tab bar
- Dark mode theme applied consistently (background, text, tab bar)
- No crashes or errors during navigation
- Safe areas handled (content not behind notch/status bar)
</success_criteria>

<output>
After completion, create `.planning/phases/01-foundation/01-02-SUMMARY.md`
</output>
